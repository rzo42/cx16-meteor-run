310 bt=255:by=bt+1:cb=$a040:pb=$a240:rb=$A008:y1=$9fe0:y2=y1+1
312 fort=0to7:ct(t)=cb+(t*64):pt(t)=pb+(t*128):nextt
314 fort=0to6:fort2=0to7:pokey1,$20+($20*t)+t2:pokey2,peek(rb+(t*8)+t2)
316 nextt2:nextt
318 cl=peek(rb-8):pl=peek(rb-7):nl=peek(rb-6):nd=ti+nl
320 cc=0:pc=0
322 vc=0
324 nv=peek(pt(vc)+pc+peek(ct(vc)+cc)):ifnv>1thenpokey1,$28+vc:POKEy2,nv
326 ifvc<7thenvc=vc+1:goto324
328 vc=0:pokey1,$08
330 nv=peek(pt(vc)+pc+peek(ct(vc)+cc)):ifnv>1thenpokey2,$08+vc
332 ifvc<7thenvc=vc+1:goto330
334 ifti<ndthen334
336 nd=ti+nl
338 vc=0:pokey1,$08
340 nv=peek(pt(vc)+pc+peek(ct(vc)+cc)):ifnotnv=1thenpokey2,$00+vc
342 ifvc<7thenvc=vc+1:goto340
344 ifpc=plthenpc=0:goto348
346 pc=pc+1:goto322
348 ifcc=clthencc=0:end
350 cc=cc+1:goto322